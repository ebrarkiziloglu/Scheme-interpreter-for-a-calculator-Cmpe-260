(parse_expr '(1 + 3))
'(+ 1 3)
(parse_expr '(1 + x))
'(+ 1 x)
(parse_expr '(3 + 4 * 7))
'(+ 3 (* 4 7))
(parse_expr '(3 * 4 + 7))
'(+ (* 3 4) 7)
(parse_expr '(3 * (4 + 7)))
'(* 3 (+ 4 7))
(parse_expr '(((((3 + 4))))))
'(+ 3 4)
(parse_expr '(3))
3
(parse_expr '(('x := 5 --) @ (x + 1.618)))
'(let ((x 5)) (+ x 1.618))
(parse_expr '(('x := 5 --) @ (('x := 6 --) @ (x * x))))
'(let ((x 5)) (let ((x 6)) (* x x)))

(parse_expr '(('x := 5 --) @ (x * ('x := 6 --) @ (x))))
'(let ((x 5)) (* x (let ((x 6)) x)))
(parse_expr '(('x := 5 --) @ (y * ('x := 6 --) @ (x))))
'(let ((x 5)) (* y (let ((x 6)) x)))
(parse_expr '(1 + 7 + 6 + 1 + 34 * (('x := 3 -- 'y := 6 --) @ (5 * (x + y + ('z := 'x --) @ (z)))) + 5 ))
'(+ 1 7 6 1 (* 34 (let ((x 3) (y 6)) (* 5 (+ x y (let ((z x)) z))))) 5)
'(+ 1 7 6 1 (* 34 (let ((x 3) (y 6)) (* 5 (+ x y (let ((z 'x)) z))))) 5)

> (parse_expr '(('a := 1 -- 'b := 2 -- 'c := 3 -- 'd := 4 --) @ (('a := 95 --) @ (('d := 47 --) @ (('d := 60 --) @ (a) + ('b := 11 --) @ (69) + 38 + c + 85 + ('b := 64 --) @ (('c := 89 --) @ ((('d := 29 --) @ (('c := 65 --) @ (73)))) + 26) * 22 * ('a := 65 --) @ (c + b) * ('a := 16 --) @ (2) * b * 7 * 98 + 73 * 96 + c + 88 + ('c := 46 --
'd := 58 -- 'a := 13 --) @ (('d := 82 --) @ (('d := 45 --) @ ((d + d) * 52 + ('b := 30 --) @ (81))) * ('a := 71 --) @ ((('d := 8 --) @ (d * 25 * c * ((('d := 12 --) @ (b))) + 32))) * 42) + 18 * (c) + ('c := 34 -- 'a := 98 --) @ (80) + 87 + 61 + 72))
+ 36 * (((b) * 61)) + (25) + 17 * (a))))

(eval_expr '(1 + 3))
4
(eval_expr '(1 + x))
ERROR
(eval_expr '(3 + 4 * 7))
31
(eval_expr '(3 * 4 + 7))
19
(eval_expr '(3 * (4 + 7)))
33
(eval_expr '(((((3 + 4))))))
7
(eval_expr '(3))
3
(eval_expr '(('x := 5 --) @ (x + 1.618)))
6.618
(eval_expr '(('x := 5 --) @ (('x := 6 --) @ (x * x))))
36
(eval_expr '(('x := 5 --) @ (x * ('x := 6 --) @ (x))))
30
(eval_expr '(('x := 5 --) @ (y * ('x := 6 --) @ (x))))
ERROR
(eval_expr '(1 + 7 + 6 + 1 + 34 * (('x := 3 -- 'y := 6 --) @ (5 * (x + y + ('z := 'x --) @ (z)))) + 5 ))
2060
(eval_expr '(('a := 1 -- 'b := 2 -- 'c := 3 -- 'd := 4 --) @ (('a := 95 --) @ (('d := 47 --) @ (('d := 60 --) @ (a) + ('b := 11 --) @ (69) + 38 + c + 85 + ('b := 64 --) @ (('c := 89 --) @ ((('d := 29 --) @ (('c := 65 --) @ (73)))) + 26) * 22 * ('a := 65 --) @ (c + b) * ('a := 16 --) @ (2) * b * 7 * 98 + 73 * 96 + c + 88 + ('c := 46 --
'd := 58 -- 'a := 13 --) @ (('d := 82 --) @ (('d := 45 --) @ ((d + d) * 52 + ('b := 30 --) @ (81))) * ('a := 71 --) @ ((('d := 8 --) @ (d * 25 * c * ((('d := 12 --) @ (b))) + 32))) * 42) + 18 * (c) + ('c := 34 -- 'a := 98 --) @ (80) + 87 + 61 + 72))
+ 36 * (((b) * 61)) + (25) + 17 * (a))))
3715593921



(eval_expr '())

(eval_expr '(('d := 85 --) @ (('b := 7 --) @ (('b := 73 --) @ (('b := 43 --) @ (('d := 55 --) @ (90)) * 82))) ))
